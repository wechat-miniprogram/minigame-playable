{"version":3,"sources":["file:///Users/yuanzimin/Downloads/cocos-example-ball-master/assets/script/game/camera-ctrl.ts"],"names":["_decorator","Component","Node","Vec3","Constants","ccclass","property","_tempPos","CameraCtrl","preType","BOARD_TYPE","NORMAL","_originPos","start","set","CAMERA_INIT_POS","setPosition","node","eulerAngles","CAMERA_INIT_ROT","setOriginPosX","val","x","setOriginPosY","y","update","position","Math","abs","CAMERA_MOVE_MINI_ERR","CAMERA_MOVE_X_FRAMES","SPRING","CAMERA_MOVE_Y_FRAMES_SPRING","CAMERA_MOVE_Y_FRAMES","reset","planeNode"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2019 Xiamen Yaji Software Co.Ltd. All rights reserved.\n * Created by daisy on 2019/06/25.\n */\nimport { _decorator, Component, Node, Vec3 } from \"cc\";\nimport { Constants } from \"../data/constants\";\nconst { ccclass, property } = _decorator;\n\nconst _tempPos = new Vec3();\n\n@ccclass(\"CameraCtrl\")\nexport class CameraCtrl extends Component {\n    @property(Node)\n    planeNode: Node = null!;\n\n    preType = Constants.BOARD_TYPE.NORMAL;\n    _originPos = new Vec3();\n\n    start () {\n        this._originPos.set(Constants.CAMERA_INIT_POS);\n        this.setPosition(this._originPos);\n        this.node.eulerAngles = Constants.CAMERA_INIT_ROT;\n    }\n\n    setOriginPosX(val: number){\n        this._originPos.x = val;\n    }\n\n    setOriginPosY(val: number) {\n        this._originPos.y = val;\n    }\n\n    update() {\n        _tempPos.set(this.node.position);\n        if(_tempPos.x === this._originPos.x && _tempPos.y === this._originPos.y){\n            return;\n        }\n\n        // 横向位置误差纠正\n        if (Math.abs(_tempPos.x - this._originPos.x) <= Constants.CAMERA_MOVE_MINI_ERR) {\n            _tempPos.x = this._originPos.x;\n            this.setPosition(_tempPos);\n        } else {\n            const x = this._originPos.x - _tempPos.x;\n            _tempPos.x += x / Constants.CAMERA_MOVE_X_FRAMES;\n            this.setPosition(_tempPos);\n        }\n\n        _tempPos.set(this.node.position);\n         // 纵向位置误差纠正\n        if (Math.abs(_tempPos.y - this._originPos.y) <= Constants.CAMERA_MOVE_MINI_ERR) {\n            _tempPos.y = this._originPos.y;\n            this.setPosition(_tempPos);\n        } else {\n            const y = this._originPos.y - _tempPos.y;\n            if (this.preType === Constants.BOARD_TYPE.SPRING) {\n                _tempPos.y += y / Constants.CAMERA_MOVE_Y_FRAMES_SPRING;\n\n                this.setPosition(_tempPos);\n            } else {\n                _tempPos.y += y / Constants.CAMERA_MOVE_Y_FRAMES;\n                this.setPosition(_tempPos);\n            }\n        }\n    }\n\n    // 相机的默认位置\n    reset() {\n        this._originPos.set(Constants.CAMERA_INIT_POS);\n        this.setPosition(this._originPos);\n    }\n\n    // 相机更新的同时更新背景板\n    setPosition(position: Vec3) {\n        this.node.setPosition(position);\n        const y = position.y - 27;\n        this.planeNode.setPosition(position.x, y, -100);\n    }\n}\n"]}