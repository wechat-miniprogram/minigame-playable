{"version":3,"sources":["file:///Users/yuanzimin/Downloads/cocos-example-ball-master/assets/script/game/revive.ts"],"names":["_decorator","Component","SpriteComponent","WidgetComponent","Label","Constants","ccclass","property","Revive","type","closeCb","pageResult","onEnable","show","score","game","scoreLabel","string","toString","MAX_SCORE","historyLabel","countDownTime","progressLabel","currentTime","spCountDown","fillRange","isCountDowning","onBtnReviveClick","audioManager","playClip","node","emit","GAME_EVENT","REVIVE","showResult","onBtnSkipClick","gameOver","update","dt","spare","Math","ceil","percent"],"mappings":"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","sourcesContent":["import { _decorator, Component, SpriteComponent, Node, WidgetComponent, Label } from \"cc\";\nimport { Constants } from \"../data/constants\";\nimport { PageResult } from \"./page-result\";\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"Revive\")\nexport class Revive extends Component {\n    /* class member could be defined like this */\n    // dummy = '';\n\n    /* use `property` decorator if your want the member to be serializable */\n\n    closeCb: Function = null;\n\n    @property(WidgetComponent)\n    wgMenu: WidgetComponent = null;\n\n    @property(Label)\n    historyLabel: Label = null;\n\n    @property({ type: Label })\n    scoreLabel: Label = null;\n\n    @property({ type: Label })\n    progressLabel: Label = null;\n\n    @property(SpriteComponent)\n    spCountDown: SpriteComponent = null;  //倒计时\n\n    pageResult: PageResult = null;\n    countDownTime: number;\n    currentTime: number;\n    isCountDowning: boolean;\n\n    onEnable() {\n        this.show();\n    }\n\n    show() {\n        const score = Constants.game.score;\n        this.scoreLabel.string = score.toString();\n        if (Constants.MAX_SCORE < score){\n            Constants.MAX_SCORE = score;\n        }\n\n        this.historyLabel.string = Constants.MAX_SCORE.toString();\n\n        // this.closeCb = closeCallback;\n        this.countDownTime = 5;\n        this.progressLabel.string = this.countDownTime + '';\n        this.currentTime = 0;\n        this.spCountDown.fillRange = 1;\n        this.isCountDowning = true;\n    }\n\n    onBtnReviveClick() {\n        this.isCountDowning = false;\n        Constants.game.audioManager.playClip();\n\n        Constants.game.node.emit(Constants.GAME_EVENT.REVIVE);\n        this.pageResult.showResult(false);\n        // uiManager.instance.hideDialog('fight/revive');\n    }\n\n    onBtnSkipClick() {\n        Constants.game.audioManager.playClip();\n        this.isCountDowning = false;\n        // uiManager.instance.hideDialog('fight/revive');\n\n        // this.closeCb && this.closeCb();\n        Constants.game.gameOver();\n    }\n\n    update(dt: number) {\n        if (!this.isCountDowning) {\n            return;\n        }\n\n        this.currentTime += dt;\n\n        let spare = this.countDownTime - this.currentTime;\n        this.progressLabel.string = Math.ceil(spare) + '';\n        if (spare <= 0) {\n            spare = 0;\n\n            //触发倒计时结束\n            this.isCountDowning = false;\n            this.onBtnSkipClick();\n        }\n\n        let percent = spare / this.countDownTime; // 展示百分比\n        this.spCountDown.fillRange = percent;\n\n\n    }\n\n}\n"]}